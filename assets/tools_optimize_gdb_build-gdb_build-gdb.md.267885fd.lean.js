import{_ as l,r as e,o as p,c as o,a as r,b as c}from"./app.a2daf185.js";const t="/assets/test-python.1a11d479.svg",g=JSON.parse('{"title":"编译全功能GDB","description":"","frontmatter":{},"headers":[{"level":2,"title":"1.概述","slug":"_1-概述","link":"#_1-概述","children":[]},{"level":2,"title":"2.编译python","slug":"_2-编译python","link":"#_2-编译python","children":[{"level":3,"title":"2.1 下载python","slug":"_2-1-下载python","link":"#_2-1-下载python","children":[]},{"level":3,"title":"2.2 编译python","slug":"_2-2-编译python","link":"#_2-2-编译python","children":[]}]},{"level":2,"title":"3.编译GDB","slug":"_3-编译gdb","link":"#_3-编译gdb","children":[{"level":3,"title":"3.1 下载GDB","slug":"_3-1-下载gdb","link":"#_3-1-下载gdb","children":[]},{"level":3,"title":"3.2 编译带有全功能的gdb","slug":"_3-2-编译带有全功能的gdb","link":"#_3-2-编译带有全功能的gdb","children":[]},{"level":3,"title":"3.3 测试","slug":"_3-3-测试","link":"#_3-3-测试","children":[]},{"level":3,"title":"3.4 编译aarch64目标平台gdb","slug":"_3-4-编译aarch64目标平台gdb","link":"#_3-4-编译aarch64目标平台gdb","children":[]}]},{"level":2,"title":"小结","slug":"小结","link":"#小结","children":[]}],"relativePath":"tools/optimize/gdb/build-gdb/build-gdb.md"}'),i={name:"tools/optimize/gdb/build-gdb/build-gdb.md"};function d(n,s,b,h,y,F){const a=e("Vssue");return p(),o("div",null,[s[0]||(s[0]=r(`<h1 id="编译全功能gdb" tabindex="-1">编译全功能GDB <a class="header-anchor" href="#编译全功能gdb" aria-hidden="true">#</a></h1><hr><table><thead><tr><th>软件版本</th><th>硬件版本</th><th>更新内容</th></tr></thead><tbody><tr><td>gdb-10.1</td><td>amd64</td><td></td></tr></tbody></table><hr><h2 id="_1-概述" tabindex="-1">1.概述 <a class="header-anchor" href="#_1-概述" aria-hidden="true">#</a></h2><p>平时我们使用<code>apt install gdb</code>或者<code>yum install gdb</code>安装的gdb,可能功能不是最全的，比如我的使用场景中会存在如下两个功能需求：</p><ol><li>host 平台是x86_64，但目标平台是aarch64</li><li>需要支持python，这样可以装插件或者做一些分析工具</li></ol><p>普通方式安装的<code>gdb</code>无法满足需求，这时需要我们自己来编译安装具备特定功能的<code>gdb</code>.</p><h2 id="_2-编译python" tabindex="-1">2.编译python <a class="header-anchor" href="#_2-编译python" aria-hidden="true">#</a></h2><p>这里为什么要编译python,原因是我们平时安装的python其实只是python的库和python解析器，但是我们在编译一些其他的软件时，是需要<code>libpythonxxx.so</code>,这种动态连接库的，所以我们需要编译python源码，当然你可以通过<code>apt install python-dev</code>来安装，我这里为了展示编译过程，选择从源来编译安装。</p><h3 id="_2-1-下载python" tabindex="-1">2.1 下载python <a class="header-anchor" href="#_2-1-下载python" aria-hidden="true">#</a></h3><p>因为我们gdb只支持python2（只是从一些资料了解到，但没有从官方的文档中确认），所以我这下载<code>python2.7.18</code>代码，下载如下</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F8F8F2;">wget </span><span style="color:#E6DB74;">https://www.python.org/ftp/python/2.7.18/Python-2.7.18.tgz</span></span>
<span class="line"><span style="color:#F8F8F2;">tar </span><span style="color:#AE81FF;">-xvf</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">Python-2.7.18.tgz</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_2-2-编译python" tabindex="-1">2.2 编译python <a class="header-anchor" href="#_2-2-编译python" aria-hidden="true">#</a></h3><p>编译如下：</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai"><code><span class="line"></span>
<span class="line"><span style="color:#88846F;"># 新建安装目录</span></span>
<span class="line"><span style="color:#F8F8F2;">mkdir </span><span style="color:#E6DB74;">python-install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#66D9EF;">cd</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">Python-2.7.18</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 新建编译目录</span></span>
<span class="line"><span style="color:#F8F8F2;">mkdir </span><span style="color:#E6DB74;">build</span></span>
<span class="line"><span style="color:#66D9EF;">cd</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">build</span></span>
<span class="line"><span style="color:#88846F;"># 配置,这半 --prefix 安装路径必须是绝对路径</span></span>
<span class="line"><span style="color:#66D9EF;">..</span><span style="color:#F8F8F2;">/configure </span><span style="color:#AE81FF;">--prefix=/home/dongzaiq/Downloads/python-install</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">--enable-shared</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 编译安装</span></span>
<span class="line"><span style="color:#F8F8F2;">make</span></span>
<span class="line"><span style="color:#F8F8F2;">make </span><span style="color:#E6DB74;">install</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>以上过程，如果需要缺少一些，请根据错误提示自行安装</p><h2 id="_3-编译gdb" tabindex="-1">3.编译GDB <a class="header-anchor" href="#_3-编译gdb" aria-hidden="true">#</a></h2><h3 id="_3-1-下载gdb" tabindex="-1">3.1 下载GDB <a class="header-anchor" href="#_3-1-下载gdb" aria-hidden="true">#</a></h3><p>根据需要下载相应的<code>gdb</code>版本，我这里下载<code>8.3</code>版本</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F8F8F2;">wget </span><span style="color:#E6DB74;">http://ftp.gnu.org/gnu/gdb/gdb-10.1.tar.xz</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3-2-编译带有全功能的gdb" tabindex="-1">3.2 编译带有全功能的gdb <a class="header-anchor" href="#_3-2-编译带有全功能的gdb" aria-hidden="true">#</a></h3><p>过程如下：</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai"><code><span class="line"></span>
<span class="line"><span style="color:#88846F;"># 解压</span></span>
<span class="line"><span style="color:#F8F8F2;">tar </span><span style="color:#AE81FF;">-xvf</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">./gdb-10.1.tar.xz</span></span>
<span class="line"><span style="color:#66D9EF;">cd</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">gdb-</span><span style="color:#AE81FF;">10.1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 新建编译目录</span></span>
<span class="line"><span style="color:#F8F8F2;">mkdir </span><span style="color:#E6DB74;">build</span></span>
<span class="line"><span style="color:#66D9EF;">cd</span><span style="color:#F8F8F2;"> </span><span style="color:#E6DB74;">build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 这里python-install就是我们在\`2.2\`编译出来python</span></span>
<span class="line"><span style="color:#66D9EF;">..</span><span style="color:#F8F8F2;">/configure </span><span style="color:#AE81FF;">--enable-python=../../python-install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;"># 编译</span></span>
<span class="line"><span style="color:#F8F8F2;">make</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_3-3-测试" tabindex="-1">3.3 测试 <a class="header-anchor" href="#_3-3-测试" aria-hidden="true">#</a></h3><p>编译完成，<code>build</code>目录下的内容如下</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F92672;">~</span><span style="color:#F8F8F2;">/Downloads/gdb-</span><span style="color:#AE81FF;">10.1</span><span style="color:#F8F8F2;">/build</span></span>
<span class="line"><span style="color:#F8F8F2;">❯ </span><span style="color:#E6DB74;">ls</span></span>
<span class="line"><span style="color:#F8F8F2;">bfd  </span><span style="color:#E6DB74;">config.log</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">config.status</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">etc</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">gdb</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">intl</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">libdecnumber</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">libiberty</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">Makefile</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">opcodes</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">readline</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">serdep.tmp</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">sim</span><span style="color:#F8F8F2;">  </span><span style="color:#E6DB74;">zlib</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>编译好的<code>gdb</code>在<code>gdb/</code> 测试过程如下： <img src="`+t+`" alt="test python" title="test python fucntion"></p><h3 id="_3-4-编译aarch64目标平台gdb" tabindex="-1">3.4 编译aarch64目标平台gdb <a class="header-anchor" href="#_3-4-编译aarch64目标平台gdb" aria-hidden="true">#</a></h3><p>编译aarch64目标平台gdb，其实大体过程和上面一样，只是在<code>configure</code>时，加下如下选项</p><div class="language-sh line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki monokai"><code><span class="line"><span style="color:#F8F8F2;">configure </span><span style="color:#AE81FF;">--host=x86_64-linux-gnu</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">--target=aarch64-linux-gnu</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="小结" tabindex="-1">小结 <a class="header-anchor" href="#小结" aria-hidden="true">#</a></h2><p>在这里我们介绍编译带有<code>python2</code>功能和支持<code>aarch64</code>功能的<code>gdb</code>,如果你需要其实的gdb功能，也可以自己做配置，总之<code>gdb</code>是一个神器，用好它，可以帮助我们解析很多问题。</p><hr><div class="tip custom-block"><p class="custom-block-title">Tip</p><p>欢迎评论、探讨,如果发现错误请指正。转载请注明出处！ <a href="http://www.tsz.wiki" target="_blank" rel="noreferrer">探索者</a></p></div><hr>`,36)),c(a,{title:n.$title},null,8,["title"])])}const m=l(i,[["render",d]]);export{g as __pageData,m as default};
