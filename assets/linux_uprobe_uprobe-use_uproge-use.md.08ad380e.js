import{_ as p,r as l,o,c as e,a as t,b as r}from"./app.a2daf185.js";const m=JSON.parse('{"title":"UPROBE使用说明","description":"","frontmatter":{},"headers":[],"relativePath":"linux/uprobe/uprobe-use/uproge-use.md"}'),c={name:"linux/uprobe/uprobe-use/uproge-use.md"};function F(n,s,y,u,i,b){const a=l("Vssue");return o(),e("div",null,[s[0]||(s[0]=t(`<h1 id="uprobe使用说明" tabindex="-1">UPROBE使用说明 <a class="header-anchor" href="#uprobe使用说明" aria-hidden="true">#</a></h1><hr><table><thead><tr><th>软件版本</th><th>硬件版本</th><th>更新内容</th></tr></thead><tbody><tr><td>linux 5.8.18</td><td>arm64</td><td></td></tr></tbody></table><hr><div class="language-c line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki monokai"><code><span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">echo </span><span style="color:#E6DB74;">&quot;p:test_two /root/test/uprobe/test-uprobe-arm64:0x0 arg1=</span><span style="color:#AE81FF;">%x</span><span style="color:#E6DB74;">0 arg2=</span><span style="color:#AE81FF;">%x</span><span style="color:#E6DB74;">1&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#F92672;">&gt;</span><span style="color:#F8F8F2;"> .</span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;">uprobe_events</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">/* 查看寄存器的值 */</span></span>
<span class="line"><span style="color:#F8F8F2;">sudo .</span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;">test.sh p test</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">uprobe</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">amd64 test_two </span><span style="color:#E6DB74;">&quot;arg1=</span><span style="color:#AE81FF;">%d</span><span style="color:#E6DB74;">i arg2=</span><span style="color:#AE81FF;">%s</span><span style="color:#E6DB74;">i&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">/* 查看某个内存地址的值，eg: 查看全局变量 */</span></span>
<span class="line"><span style="color:#F8F8F2;">objdump </span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">t  .</span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;">test</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">uprobe</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">amd64 </span><span style="color:#F92672;">|</span><span style="color:#F8F8F2;"> grep g_val</span></span>
<span class="line"><span style="color:#F44747;">00000000004c00f0</span><span style="color:#F8F8F2;"> l     O .data  </span><span style="color:#F92672;">0</span><span style="color:#AE81FF;">000000000000004</span><span style="color:#F8F8F2;"> g_val</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2;">sudo .</span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;">test.sh p test</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">uprobe</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">amd64 test_two </span><span style="color:#E6DB74;">&quot;arg1=@0x4c00f0&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">/* 查看某个函数的返回值 */</span></span>
<span class="line"><span style="color:#F8F8F2;">sudo .</span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;">test.sh r test</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">uprobe</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">amd64 test_two </span><span style="color:#E6DB74;">&quot;ret=</span><span style="color:#F44747;">\\$</span><span style="color:#E6DB74;">retval:u32&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">/* 查看结构体ts/g_ts的val变量 */</span></span>
<span class="line"><span style="color:#F8F8F2;">sudo .</span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;">test.sh p test</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">uprobe</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">amd64 test_three </span><span style="color:#E6DB74;">&quot;arg=+0(</span><span style="color:#AE81FF;">%d</span><span style="color:#E6DB74;">i):x32&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">/* 查看结构体ts/g_ts的ary的第一个元素 */</span></span>
<span class="line"><span style="color:#F8F8F2;">sudo .</span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;">test.sh p test</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">uprobe</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">amd64 test_three </span><span style="color:#E6DB74;">&quot;arg=+0(</span><span style="color:#AE81FF;">%d</span><span style="color:#E6DB74;">i):x32&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">/* 查看结构体ts/g_ts的ary的数组的第一个元素 */</span></span>
<span class="line"><span style="color:#F8F8F2;">sudo .</span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;">test.sh p test</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">uprobe</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">amd64 test_three </span><span style="color:#E6DB74;">&quot;arg=+4(</span><span style="color:#AE81FF;">%d</span><span style="color:#E6DB74;">i):x32&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">/* 查看结构体ts/g_ts的ary的 p 的值 */</span></span>
<span class="line"><span style="color:#F8F8F2;">sudo .</span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;">test.sh p test</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">uprobe</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">amd64 test_three </span><span style="color:#E6DB74;">&quot;arg=+24(</span><span style="color:#AE81FF;">%d</span><span style="color:#E6DB74;">i):x32&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#88846F;">/* 查看栈地址 */</span></span>
<span class="line"><span style="color:#F8F8F2;">sudo .</span><span style="color:#F92672;">/</span><span style="color:#F8F8F2;">test.sh p test</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">uprobe</span><span style="color:#F92672;">-</span><span style="color:#F8F8F2;">amd64 test_four </span><span style="color:#E6DB74;">&quot;stack=</span><span style="color:#F44747;">\\$</span><span style="color:#E6DB74;">stack&quot;</span><span style="color:#F8F8F2;"> </span><span style="color:#AE81FF;">10</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">提示</p><p>目前无法查看ts/g_ts的p指向的内存的数据，只有查看到p指向的内存地址，无法查看该内存中保存的数据 执行 <code>sudo ./test.sh p test-uprobe-amd64 test_three &quot;arg=@(+24(%di):x32)&quot; 10</code> 报错</p></div><hr><div class="tip custom-block"><p class="custom-block-title">提示</p><p>欢迎评论、探讨,如果发现错误请指正。转载请注明出处！ <a href="http://www.tsz.wiki" target="_blank" rel="noreferrer">探索者</a></p></div><hr>`,9)),r(a,{title:n.$title},null,8,["title"])])}const E=p(c,[["render",F]]);export{m as __pageData,E as default};
